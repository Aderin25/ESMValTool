datasets:
  - {dataset: EC-Earth3-HR, expid: a0xi, institute: EC-Earth-Consortium, grid: gr,
     project: PRIMAVERA, exp: piControl,  ensemble: r1i1p1f1, version: v20180308,
     start_year: 1950,  end_year: 1950}
  # - {dataset: EC-Earth3-LR, expid: a13c, institute: EC-Earth-Consortium, grid: gr,
  #   project: PRIMAVERA, exp: piControl,  ensemble: r1i1p1f1, version: v20180308,
  #   start_year: 1950,  end_year: 1950}
#  - {dataset: ERA-Interim,  project: OBS,  type: reanaly,  version: 1,
#     start_year: 1980, end_year: 1980,  tier: 3, cmor_table: CMIP6}
preprocessors:
  extract:
    extract_levels:
      levels: [50000,]
      scheme: nearest
    extract_region:
      start_longitude: 0
      end_longitude: 360
      start_latitude: 20
      end_latitude: 90
    save:
      optimize_access: longitude time

  regrid:
    regrid:
      target_grid: 2.5x2.5
      scheme: linear
    extract_levels:
      levels: [50000,]
      scheme: nearest
    extract_region:
      start_longitude: 0
      end_longitude: 360
      start_latitude: 20
      end_latitude: 90

diagnostics:
  blocking:
    description: Blocking
    variables:
      zg:
        reference_dataset: ERA-Interim
        mip: day
        field: T2M
        preprocessor: extract
    scripts:
      # blocking1D:
      #   script: blocking/blocking.py
      #   title: "Blocking diagnostic 1D"
      #   compute_2d: False
      #   compute_1d: True
      #   central_latitude: 60.0
      #   span: 20.0
      #   offset: 5.0
      #   north_threshold: -10.0
      #   south_threshold: 0.0
      #   smoothing_window: 5
      #   max_color_scale: 10

      blocking2D:
        script: blocking/blocking.py
        title: "Blocking diagnostic 2D"
        compute_2d: True
        compute_1d: False
        span: 15.0
        north_threshold: -10.0
        south_threshold: 0.0
        persistence: 5
        max_color_scale: 10

#  regridded_blocking:
#    description: Blocking
#    variables:
#      zg:
#        reference_dataset: ERA-Interim
#        mip: day
#        field: T2M
#        preprocessor: regrid
#    scripts:
#      blocking:
#        script: blocking/blocking.py
#        title: "Blocking diagnostic"
#        central_latitude: 60.0
#        span: 20.0
#        offset: 5.0
#        north_threshold: -10.0
#        south_threshold: 0.0
##        months: [1,2]
#        smoothing_window: 3
#        max_color_scale: 10
