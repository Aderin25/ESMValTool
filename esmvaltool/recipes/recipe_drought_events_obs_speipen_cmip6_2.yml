---
documentation:

  description: |
    Calculate the SPEI of few models
  authors:
    - schl_ma

  references:
    - andrews12grl

  projects:
    - crescendo

preprocessors:
  preprocessor1:
    regrid:
      target_grid: reference_dataset
      scheme: linear

diagnostics:
  diagnostic1:
    variables:
      pr:
        reference_dataset: ERA-Interim
        preprocessor: preprocessor1
        field: T2Ms
      tasmin:
        reference_dataset: ERA-Interim
        preprocessor: preprocessor1
        field: T2Ms
      tasmax:
        reference_dataset: ERA-Interim
        preprocessor: preprocessor1
        field: T2Ms
      sfcWind:
        reference_dataset: ERA-Interim
        preprocessor: preprocessor1
        field: T2Ms
      clt: #clt OR rsds, never use both! (ERA-Interim contains only clt)
        reference_dataset: ERA-Interim
        preprocessor: preprocessor1
        field: T2M
      psl:
        reference_dataset: ERA-Interim
        preprocessor: preprocessor1
        field: T2M
    additional_datasets:
      - {dataset: ERA-Interim, project: OBS6, type: reanaly,
         version: 1, start_year: 1979, end_year: 2014, tier: 3}
      - {dataset: MIROC6, institute: MIROC, mip: Amon,
         project: CMIP6, exp: historical, ensemble: r1i1p1f1,
         grid: gn, start_year: 1979, end_year: 2014}
      - {dataset: GFDL-CM4, institute: NOAA-GFDL, mip: Amon,
         project: CMIP6, exp: historical, ensemble: r1i1p1f1,
         grid: gr1, start_year: 1979, end_year: 2014}
      - {dataset: IPSL-CM6A-LR, institute: IPSL, mip: Amon,
         project: CMIP6, exp: historical, ensemble: r1i1p1f1,
         grid: gr, start_year: 1979, end_year: 2014}
      - {dataset: MRI-ESM2-0, institute: MRI, mip: Amon,
         project: CMIP6, exp: historical, ensemble: r1i1p1f1,
         grid: gn, start_year: 1979, end_year: 2014}
      - {dataset: CNRM-ESM2-1, institute: CNRM-CERFACS,
         mip: Amon, project: CMIP6, exp: historical,
         ensemble: r1i1p1f2, grid: gr, start_year: 1979, end_year: 2014}
      - {dataset: CNRM-CM6-1, institute: CNRM-CERFACS, mip: Amon,
         project: CMIP6, exp: historical, ensemble: r1i1p1f2,
         grid: gr, start_year: 1979, end_year: 2014}
      - {dataset: BCC-CSM2-MR, institute: BCC, mip: Amon,
         project: CMIP6, exp: historical, ensemble: r1i1p1f1,
         grid: gn, start_year: 1979, end_year: 2014}

    scripts:
      script1:
        script: droughtindex/diag_save_spei_pen.r

  spi_collect2:
    description: Wrapper to collect and plot previously calculated SPEI index
    scripts:
      spi_collect2:
        script: droughtindex/collect_spei_obs_multi.py
        ancestors: ['diagnostic1/script1']
